# Project Management Skill

複雑なマルチステップタスクを管理するためのスキル。目的を見失わず、計画を適応させながら進行を追跡する。

## このスキルを使う場面

- 3ステップ以上の複雑なタスク
- 不確実性が高い作業（解決策が不明、複数の試行が予想される）
- 進捗を見失いやすい作業
- `.claude/project-coordinator/` にファイルが存在する（進行中のプロジェクト）

## 核となる原則

**自律的に計画・実行する。ただし目的は守る。**

- 目的定義 → ユーザーとの協働（必須のやりとり）
- 計画・実行 → 自律的に進める
- **ユーザーへの報告** → 各ステップ完了時、障害発生時に必ず報告
- エスカレーション → 目的が不明確、または矛盾が生じた時のみ

## ドキュメント管理 (`.claude/project-coordinator/`)

### 1. purpose.md - 不変の北極星

**内容:** 元の目的、背景、成功基準、スコープ

**⚠️ 重要:** 更新するのは以下の場合のみ
- ユーザーが要請した時
- 前提が無効化された時
- 技術的に不可能と判明した時

**実装の困難さは目的変更の理由にならない** → plan.mdを調整する

### 2. plan.md - プロジェクト計画

**内容:** 進捗率、ステップと完了基準、依存関係、リスク、Plan B、完了ログ

**更新タイミング:**
- ステップ完了後
- 障害発生時
- 新情報で実現可能性が変わった時

### 3. work_summary.md / work_log_XX.md (investigator管理)

**オーナー:** investigatorエージェント

**このスキルでの役割:** work_summary.mdを読んで状況確認。詳細が必要ならwork_log_XX.mdを参照。

## 実行フロー

### 1. 初期化

1. `.claude/project-coordinator/` の既存ドキュメントを確認
2. **purpose.mdを最優先で確認:**
   - 存在して明確 → plan.md作成へ
   - 不在または不明確 → purpose-extractorに委譲
3. plan.mdを自律的に作成
4. **ユーザーに計画を報告**

### 2. 実行と追跡

1. ステップを実行し、チェックポイントでplan.mdを更新
2. **調査タスク:** investigatorに委譲（後述）
   - investigatorが5回"NO"で戻ってきた場合: 計画修正またはユーザーに相談
3. **各ステップ完了時:** ユーザーに進捗を報告
4. 行き詰まった時: 全ドキュメントを再確認し、purpose.mdに照らして再評価

### 3. 計画修正

**計画は柔軟に。目的は不変。**

1. 修正のトリガーを明記
2. purpose.mdの変更が必要か判断:
   - NO → plan.mdを更新
   - YES → **停止** - ユーザーに相談（スコープ変更）
3. **計画修正をユーザーに報告**

### 4. プロジェクト完了

1. purpose.mdの全成功基準が満たされているか検証
2. ユーザーに確認: 「アーカイブを作成してからクリアしますか？」
3. YESの場合: `archives/[topic]_[YYYYMMDD].md` を作成
4. purpose.md, plan.md, work_summary.md, work_log_*.md をクリア

**⚠️ ユーザー確認なしにファイルをクリアしない**

## エージェント委譲

Task toolを使って専門エージェントに委譲する。

### purpose-extractor - 目的が不明確な時

```
Task tool:
  subagent_type: "project-coordinator:purpose-extractor"
  prompt: "[ユーザーのリクエストと背景情報]"
```

### investigator - 調査が必要な時

原因不明、複数の仮説がある、体系的な排除が必要な場合に使用。

```
Task tool:
  subagent_type: "project-coordinator:investigator"
  prompt: |
    ## Context
    [目的の要約]

    ## Current Step
    [plan.mdの該当ステップ]

    ## Task
    [調査の詳細指示]
```

**⚠️ 重要:** 「Xに委譲する」と考えたら、必ずTask toolを実行する。

## ユーザーへの報告（重要）

**このスキルの核心的な価値は可視性の提供。**

以下のタイミングで必ずユーザーに報告する:

| タイミング | 報告内容 |
|-----------|---------|
| 計画作成後 | 全体計画の概要、ステップ数、予想されるリスク |
| 各ステップ完了時 | 完了したこと、次のステップ、進捗率 |
| 障害発生時 | 何が起きたか、どう対処するか |
| 計画修正時 | 修正理由、変更内容 |
| investigator委譲時 | 調査中であること、何を調べているか |
| プロジェクト完了時 | 成果のサマリー |

## TodoWriteとの使い分け

- **TodoWrite**: 予測可能なタスクに使用
- **plan.md**: 不確実で頻繁な修正が必要な作業に使用
- 両者は独立しており、同期は不要

## 終了条件

以下の場合にこのスキルの適用を終了:

1. 計画が完了した（全ステップ完了）
2. 目的の修正が必要（ユーザーに相談後）
3. 計画修正を繰り返しても進まない
